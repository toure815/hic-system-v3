services:
  # -------------------------------------------------------
  # ðŸš€ Backend â€” Encore API
  # -------------------------------------------------------
  - type: web
    name: hic-backend
    rootDir: backend

    buildCommand: |
      npm install -g encore.dev
      npm install
      encore build

    startCommand: encore run --port 4000

    envVars:
      - key: ENCORE_APP_ENV
        value: production
      - key: SUPABASE_URL
        sync: true
      - key: SUPABASE_ANON_KEY
        sync: true

  # -------------------------------------------------------
  # ðŸŽ¨ Frontend â€” Vite App
  # -------------------------------------------------------
  - type: static
    name: hic-system
    rootDir: frontend
    buildCommand: npm install && npm run build
    publishPath: dist

    routes:
      - type: rewrite
        source: /*
        destination: /index.html

    envVars:
      - key: VITE_API_BASE_URL
        value: https://hic-backend.onrender.com
      - key: VITE_SUPABASE_URL
        sync: true
      - key: VITE_SUPABASE_ANON_KEY
        sync: true

